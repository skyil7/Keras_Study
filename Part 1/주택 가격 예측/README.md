# 주택 가격 예측
이번에 실습해 볼 문제는 개별적인 레이블 대신에 연속적인 값을 예측하는 회귀<sup>regression</sup>문제이다.

## 데이터셋
1970년 중반 보스턴 외곽 지역의 범죄율, 지방세율 등의 데이터가 주어졌을 때, 주택 가격의 중간값을 예측해보자.

이번 데이터셋은 이전 예제들과 달리 데이터 포인트가 506개로 적으며, 404개는 훈련 샘플로, 102개는 테스트 샘플로 나뉘어 있다.

입력 데이터에 있는 각 특성<sup>feature</sup>은 스케일이 서로 다른데, 어떤 값은 0~1로, 어떤 값은 1~12나 1~100의 스케일을 갖는다.

### Data Shape
`train (404, 13) / test (102, 13)`

13개의 label은 각각 1인당 범죄율, 주택당 평균 방의 개수, 고속도로 접근성 등이다.

Target은 주택의 중간 가격으로 천 달러 단위이다.

### 데이터 전처리
상이한 스케일을 가진 값을 신경망에 주입하면, 경사 하강 과정의 경로가 스케일이 큰 특성에 영향을 많이 받는 문제가 발생한다.

이러한 문제를 예방하기 위한 가장 대표적인 방법이 정규화, 혹은 표준화<sup>standardization</sup>이다. 입력 데이터에 있는 각 특성에 대해 특성의 평균을 빼고 표준 편차로 나눈다. 특성의 중앙이 0 근처로 맞춰지고 표준 편차가 1이 된다.

이때, 정규화에 사용하는 평균 및 표준편차 값은 학습용으로 분리해 놓은 데이터의 그것만을 사용해야한다.

테스트 데이터까지 포함한 평균과 표준편차를 넣으면 학습/테스트 데이터 분리가 의미없어진다.

## 회귀를 위한 출력층
예제 코드에 보면, 마지막 층이 활성화 함수 없는 하나의 유닛임을 확인할 수 있는데, 이는 전형적인 스칼라 회귀 신경망이다.

Sigmoid와 같은 활성화 함수가 없어서 넓은 범위의 예측이 가능하다.


## 오차 함수
이번에는 평균 제곱 오차를 사용하였는데, 이는 타깃과 예측값 사이의 거리의 제곱이다.

또한, 모니터링을 위한 새로운 지표로 평균 절대 오차(MAE)<sup>Mean Absolute Error</sup>를 사용하였는데, 이는 타깃과 예측값 사이의 거리의 절댓값이다.

## K겹 교차 검증<sup>K-fold cross-validation</sup>
데이터가 많지 않을 경우, 검증 세트도 매우 작아지고, 이로 인해 검증 결과의 신뢰도에 문제가 생길 수 있다.

이를 해결하기 위해 검증 데이터를 K 개로 분할하여 각 분할(fold)에 대해 정확도를 측정한 후, 이를 평균하는 K겹 교차 검증을 사용할 수 있다.